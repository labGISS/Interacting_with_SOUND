!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("leaflet")):"function"==typeof define&&define.amd?define(["leaflet"],n):(t="undefined"!=typeof globalThis?globalThis:t||self).CytoscapeLeaflet=n(t.L)}(this,(function(t){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var i=n(t);function o(t,n,i){return t(i={path:n,exports:{},require:function(t,n){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==n&&i.path)}},i.exports),i.exports}var e=o((function(t){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports})),r=o((function(t){t.exports=function(t,n){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var o,e,r=[],a=!0,s=!1;try{for(i=i.call(t);!(a=(o=i.next()).done)&&(r.push(o.value),!n||r.length!==n);a=!0);}catch(t){s=!0,e=t}finally{try{a||null==i.return||i.return()}finally{if(s)throw e}}return r}},t.exports.__esModule=!0,t.exports.default=t.exports})),a=o((function(t){t.exports=function(t,n){(null==n||n>t.length)&&(n=t.length);for(var i=0,o=new Array(n);i<n;i++)o[i]=t[i];return o},t.exports.__esModule=!0,t.exports.default=t.exports})),s=o((function(t){t.exports=function(t,n){if(t){if("string"==typeof t)return a(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?a(t,n):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports})),u=o((function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports})),l=o((function(t){t.exports=function(t,n){return e(t)||r(t,n)||s(t,n)||u()},t.exports.__esModule=!0,t.exports.default=t.exports})),h=o((function(t){t.exports=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports})),d=o((function(t){function n(t,n){for(var i=0;i<n.length;i++){var o=n[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}t.exports=function(t,i,o){return i&&n(t.prototype,i),o&&n(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports})),c=o((function(t){t.exports=function(t,n,i){return n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t},t.exports.__esModule=!0,t.exports.default=t.exports})),p=Number.isNaN||function(t){return"number"==typeof t&&t!=t};function v(t,n){if(t.length!==n.length)return!1;for(var i=0;i<t.length;i++)if(o=t[i],e=n[i],!(o===e||p(o)&&p(e)))return!1;var o,e;return!0}function f(t){return t.shiftKey||t.metaKey||t.ctrlKey}var g=function(t,n){void 0===n&&(n=v);var i=null;function o(){for(var o=[],e=0;e<arguments.length;e++)o[e]=arguments[e];if(i&&i.lastThis===this&&n(o,i.lastArgs))return i.lastResult;var r=t.apply(this,o);return i={lastResult:r,lastArgs:o,lastThis:this},r}return o.clear=function(){i=null},o}((function(t,n){return Object.fromEntries(Object.entries(n).filter((function(n){var i,o,e=l(n,2),r=e[0],a=e[1],s=t[r];return o=a,!((i=s).x===o.x&&i.y===o.y)})))})),y=null!=Object.assign?Object.assign.bind(Object):function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return i.forEach((function(n){Object.keys(n).forEach((function(i){return t[i]=n[i]}))})),t};function m(t,n){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),i.push.apply(i,o)}return i}function b(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?m(Object(i),!0).forEach((function(n){c(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}))}return t}var P=[50,50],L="cytoscape-map__hidden",x={name:"preset"},G=function(){function t(n,o,e){if(h(this,t),c(this,"cy",void 0),c(this,"mapOptions",void 0),c(this,"options",void 0),c(this,"mapContainer",void 0),c(this,"map",void 0),c(this,"originalAutoungrabify",void 0),c(this,"originalUserZoomingEnabled",void 0),c(this,"originalUserPanningEnabled",void 0),c(this,"originalPositions",void 0),c(this,"originalZoom",void 0),c(this,"originalPan",void 0),c(this,"panning",!1),c(this,"layouting",!1),c(this,"requestAnimationId",void 0),c(this,"onGraphContainerMouseDownBound",this.onGraphContainerMouseDown.bind(this)),c(this,"onGraphContainerMouseMoveBound",this.onGraphContainerMouseMove.bind(this)),c(this,"onGraphContainerWheelBound",this.onGraphContainerWheel.bind(this)),c(this,"onMapMoveBound",this.onMapMove.bind(this)),c(this,"onLayoutStartBound",this.onLayoutStart.bind(this)),c(this,"onLayoutStopBound",this.onLayoutStop.bind(this)),c(this,"onGraphAddBound",this.onGraphAdd.bind(this)),c(this,"onGraphResizeBound",this.onGraphResize.bind(this)),c(this,"onGraphDragFreeBound",this.onGraphDragFree.bind(this)),c(this,"onDataChangeBound",this.onDataChange.bind(this)),this.cy=n,this.mapOptions=o,this.options=e,"function"!=typeof this.options.getPosition)throw new Error("getPosition should be a function");if(this.options.setPosition&&"function"!=typeof this.options.setPosition)throw new Error("setPosition should be a function");this.originalAutoungrabify=this.cy.autoungrabify(),this.originalUserZoomingEnabled=this.cy.userZoomingEnabled(),this.originalUserPanningEnabled=this.cy.userPanningEnabled(),this.cy.userZoomingEnabled(!1),this.cy.userPanningEnabled(!1);var r=this.cy.container();r.addEventListener("mousedown",this.onGraphContainerMouseDownBound),r.addEventListener("mousemove",this.onGraphContainerMouseMoveBound),r.addEventListener("wheel",this.onGraphContainerWheelBound),this.cy.on("add",this.onGraphAddBound),this.cy.on("resize",this.onGraphResizeBound),this.cy.on("dragfree",this.onGraphDragFreeBound),this.cy.on("data",this.onDataChangeBound),this.cy.on("layoutstart ",this.onLayoutStartBound),this.cy.on("layoutstop",this.onLayoutStopBound),this.mapContainer=document.createElement("div"),this.mapContainer.style.position="absolute",this.mapContainer.style.top="0px",this.mapContainer.style.left="0px",this.mapContainer.style.width="100%",this.mapContainer.style.height="100%",null==r||r.prepend(this.mapContainer),this.map=new i.default.Map(this.mapContainer,this.mapOptions),this.fit(void 0,{padding:P,animate:!1}),this.map.on("move",this.onMapMoveBound),this.originalZoom=this.cy.zoom(),this.originalPan=b({},this.cy.pan());var a,s={x:0,y:0};this.options.animate?this.cy.animate({zoom:1,pan:s},{duration:null!==(a=this.options.animationDuration)&&void 0!==a?a:1,easing:"linear"}):this.cy.viewport({zoom:1,pan:s});this.enableGeographicPositions()}return d(t,[{key:"destroy",value:function(){var t,n,i,o,e,r,a,s,u,l,h=null===(t=this.cy)||void 0===t?void 0:t.container();(h&&(h.removeEventListener("mousedown",this.onGraphContainerMouseDownBound),h.removeEventListener("mousemove",this.onGraphContainerMouseMoveBound),h.removeEventListener("wheel",this.onGraphContainerWheelBound)),this.cy&&(this.cy.off("add",this.onGraphAddBound),this.cy.off("resize",this.onGraphResizeBound),this.cy.off("dragfree",this.onGraphDragFreeBound),this.cy.off("data",this.onDataChangeBound),this.cy.off("layoutstart",this.onLayoutStartBound),this.cy.off("layoutstop",this.onLayoutStopBound),this.cy.autoungrabify(this.originalAutoungrabify),this.cy.userZoomingEnabled(this.originalUserZoomingEnabled),this.cy.userPanningEnabled(this.originalUserPanningEnabled)),this.originalAutoungrabify=void 0,this.originalUserZoomingEnabled=void 0,this.originalUserPanningEnabled=void 0,null===(n=this.map)||void 0===n||n.off("move",this.onMapMoveBound),null===(i=this.map)||void 0===i||i.remove(),this.map=void 0,null===(o=this.mapContainer)||void 0===o||o.remove(),this.mapContainer=void 0,null!==(e=this.options)&&void 0!==e&&e.animate)?null===(r=this.cy)||void 0===r||r.animate({zoom:this.originalZoom,pan:this.originalPan},{duration:null!==(a=this.options.animationDuration)&&void 0!==a?a:1,easing:"linear"}):null===(s=this.cy)||void 0===s||s.viewport({zoom:null!==(u=this.originalZoom)&&void 0!==u?u:5,pan:null!==(l=this.originalPan)&&void 0!==l?l:{x:0,y:0}});this.originalZoom=void 0,this.originalPan=void 0,this.disableGeographicPositions(),this.cy=void 0,this.options=void 0}},{key:"fit",value:function(){var t,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!==(t=null===(n=this.cy)||void 0===n?void 0:n.nodes())&&void 0!==t?t:[],e=arguments.length>1?arguments[1]:void 0,r=this.getNodeLngLatBounds(o);r.isValid()&&(null===(i=this.map)||void 0===i||i.fitBounds(r,e))}},{key:"getDefaultLayout",value:function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return y(x,null===(t=this.options)||void 0===t?void 0:t.layout,n)}},{key:"runDefaultLayout",value:function(){var t,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!==(t=null===(n=this.cy)||void 0===n?void 0:n.nodes())&&void 0!==t?t:[];this.deleteInternalLayoutPosition(i),i.layout(this.getDefaultLayout()).run()}},{key:"saveInternalLayoutPositionAsLatLng",value:function(){var t,n,i=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!==(t=null===(n=this.cy)||void 0===n?void 0:n.nodes())&&void 0!==t?t:[];null==o||o.forEach((function(t){var n;t.scratch("leaflet",{currentGeoposition:null===(n=i.map)||void 0===n?void 0:n.containerPointToLatLng(t.position())})}))}},{key:"deleteInternalLayoutPosition",value:function(){var t,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!==(t=null===(n=this.cy)||void 0===n?void 0:n.nodes())&&void 0!==t?t:[];null==i||i.forEach((function(t){t.scratch("leaflet")&&t.scratch("leaflet").currentGeoposition&&delete t.scratch("leaflet").currentGeoposition}))}},{key:"enableGeographicPositions",value:function(){var t,n,i,o,e,r,a=this,s=null!==(t=null===(n=this.cy)||void 0===n?void 0:n.nodes())&&void 0!==t?t:[];this.originalPositions=Object.fromEntries(s.map((function(t){return[t.id(),b({},t.position())]})));var u=Object.fromEntries(s.map((function(t){return[t.id(),a.getGeographicPosition(t)]})).filter((function(t){var n=l(t,2);return n[0],!!n[1]}))),h=s.filter((function(t){return!u[t.id()]})),d=s.filter((function(t){return!!u[t.id()]}));null!==(i=this.options)&&void 0!==i&&i.hideNonPositional&&h.addClass(L).style("display","none"),null==d||d.layout({name:"preset",positions:u,fit:!1,animate:null===(o=this.options)||void 0===o?void 0:o.animate,animationDuration:null!==(e=null===(r=this.options)||void 0===r?void 0:r.animationDuration)&&void 0!==e?e:1,animationEasing:"ease-out-cubic"}).run(),null==h||h.layout(this.getDefaultLayout()).run()}},{key:"updateGeographicPositions",value:function(){var t,n,i=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!==(t=null===(n=this.cy)||void 0===n?void 0:n.nodes())&&void 0!==t?t:[],e=function(){var t,n,o,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!==(t=null===(n=i.cy)||void 0===n?void 0:n.nodes())&&void 0!==t?t:[],r=Object.fromEntries(e.map((function(t){return[t.id(),i.getGeographicPosition(t)]})).filter((function(t){var n=l(t,2);return n[0],!!n[1]}))),a=Object.fromEntries(e.map((function(t){return[t.id(),b({},t.position())]}))),s=g(a,r),u=e.filter((function(t){return!r[t.id()]})),h=e.filter((function(t){return!!r[t.id()]}));null!==(o=i.options)&&void 0!==o&&o.hideNonPositional&&u.addClass(L).style("display","none"),null==h||h.layout({name:"preset",positions:s,fit:!1}).run()};this.requestAnimationId=window.requestAnimationFrame((function(){e(o)}))}},{key:"disableGeographicPositions",value:function(){var t,n,i=null!==(t=null===(n=this.cy)||void 0===n?void 0:n.nodes())&&void 0!==t?t:[];this.deleteInternalLayoutPosition(i),this.runDefaultLayout(i),this.originalPositions=void 0}},{key:"onGraphContainerMouseDown",value:function(t){var n,i=this,o=null===(n=this.cy)||void 0===n?void 0:n.renderer();1!==t.buttons||f(t)||o.hoverData.down||(this.cy&&(this.cy.renderer().hoverData.dragging=!0),this.dispatchMapEvent(t),document.addEventListener("mouseup",(function(){i.panning&&(i.panning=!1,i.cy&&(i.cy.renderer().hoverData.dragged=!0))}),{once:!0}))}},{key:"onGraphContainerMouseMove",value:function(t){var n,i=null===(n=this.cy)||void 0===n?void 0:n.renderer();1!==t.buttons||f(t)||i.hoverData.down||(this.panning=!0,this.dispatchMapEvent(t))}},{key:"onGraphContainerWheel",value:function(t){t.preventDefault(),this.dispatchMapEvent(t)}},{key:"onMapMove",value:function(){this.layouting?this.updateGeographicPositions(this.filterNodes("native-geographic")):this.updateGeographicPositions()}},{key:"onLayoutStart",value:function(t){var n=t.target.options.eles;this.filterNodes("not-native-geographic",n).length>0&&(this.layouting=!0)}},{key:"onLayoutStop",value:function(t){var n=t.target.options.eles;this.filterNodes("not-native-geographic",n).length>0&&(this.layouting=!1),this.saveInternalLayoutPositionAsLatLng(n)}},{key:"onDataChange",value:function(){this.updateGeographicPositions()}},{key:"onGraphAdd",value:function(t){var n;if(t.target.isNode()){var i=t.target;this.originalPositions||(this.originalPositions={}),this.originalPositions[i.id()]=b({},i.position());var o=null===(n=this.cy)||void 0===n?void 0:n.collection().merge(i);this.updateGeographicPositions(o)}}},{key:"onGraphResize",value:function(){var t;null===(t=this.map)||void 0===t||t.invalidateSize(!1)}},{key:"onGraphDragFree",value:function(t){var n,i,o=t.target,e=null===(n=this.cy)||void 0===n?void 0:n.collection().merge(o);if(null!==(i=this.options)&&void 0!==i&&i.setPosition){var r,a=o.position(),s=[a.x,a.y],u=null===(r=this.map)||void 0===r?void 0:r.containerPointToLatLng(s);u&&this.options.setPosition(o,u)}else this.saveInternalLayoutPositionAsLatLng(e);this.updateGeographicPositions(e)}},{key:"dispatchMapEvent",value:function(t){var n,i;if(!(t.target===this.mapContainer||null!==(n=this.mapContainer)&&void 0!==n&&n.contains(t.target))){var o=new t.constructor(t.type,t);null===(i=this.map)||void 0===i||i.getContainer().dispatchEvent(o)}}},{key:"getNodeLngLat",value:function(t){var n,o;if("function"==typeof(null===(n=this.options)||void 0===n?void 0:n.getPosition)){var e=null===(o=this.options)||void 0===o?void 0:o.getPosition(t);if(e){var r;try{r=i.default.latLng(e)}catch(t){return}return r}}}},{key:"getNodeLngLatBounds",value:function(){var t,n,o=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null!==(t=null===(n=this.cy)||void 0===n?void 0:n.nodes())&&void 0!==t?t:[];return e.reduce((function(t,n){var i=o.getNodeLngLat(n);return i?t.extend(i):t}),i.default.latLngBounds([]))}},{key:"getGeographicPosition",value:function(t){var n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=i?this.getNodeLngLat(t):this.getNodeLngLat(t)||t.scratch("leaflet")&&t.scratch("leaflet").currentGeoposition;if(o)return null===(n=this.map)||void 0===n?void 0:n.latLngToContainerPoint(o)}},{key:"filterNodes",value:function(t){var n,i,o=this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null!==(n=null===(i=this.cy)||void 0===i?void 0:i.nodes())&&void 0!==n?n:[],r="native-geographic"==t||"not-native-geographic"==t,a=Object.fromEntries(e.map((function(t){return[t.id(),o.getGeographicPosition(t,r)]})).filter((function(t){var n=l(t,2);return n[0],!!n[1]})));return"geographic"==t||"native-geographic"==t?e.filter((function(t){return!!a[t.id()]})):e.filter((function(t){return!a[t.id()]}))}}]),t}();function w(t){t&&t("core","L",(function(t,n){return new G(this,t,n)}))}return void 0!==window.cytoscape&&w(window.cytoscape),w}));
//# sourceMappingURL=cytoscape-leaflet-1.0.15-multiple-layouts.min.js.map
